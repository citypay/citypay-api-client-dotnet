# CityPay API Client for DotNet

[![Build Status](https://api.travis-ci.com/citypay/citypay-api-client-dotnet.svg?branch=main)](https://app.travis-ci.com/github/citypay/citypay-api-client-dotnet)

This CityPay API is a HTTP RESTful payment API used for direct server to server transactional processing. It
provides a number of payment mechanisms including: Internet, MOTO, Continuous Authority transaction processing,
3-D Secure decision handling using RFA Secure, Authorisation, Refunding, Pre-Authorisation, Cancellation/Voids and
Completion processing. The API is also capable of tokinsed payments using Card Holder Accounts.

## Compliance and Security
Your application will need to adhere to PCI-DSS standards to operate safely and to meet requirements set out by 
Visa and MasterCard and the PCI Security Standards Council. These include

* Data must be collected using TLS version 1.2 using [strong cryptography](#enabled-tls-ciphers). We will not accept calls to our API at
  lower grade encryption levels. We regularly scan our TLS endpoints for vulnerabilities and perform TLS assessments
  as part of our compliance program.
* The application must not store sensitive card holder data (CHD) such as the card security code (CSC) or
  primary access number (PAN)
* The application must not display the full card number on receipts, it is recommended to mask the PAN
  and show the last 4 digits. The API will return this for you for ease of receipt creation
* If you are developing a website, you will be required to perform regular scans on the network where you host the
  application to meet your compliance obligations
* You will be required to be PCI Compliant and the application must adhere to the security standard. Further information
  is available from [https://www.pcisecuritystandards.org/](https://www.pcisecuritystandards.org/)
* The API verifies that the request is for a valid account and originates from a trusted source using the remote IP
  address. Our application firewalls analyse data that may be an attempt to break a large number of security common
  security vulnerabilities.


This C# SDK is automatically generated by the [OpenAPI Generator](https://openapi-generator.tech) project:

- API version: 6.4.18
- SDK version: 1.3.1
- Build package: org.openapitools.codegen.languages.CSharpNetCoreClientCodegen
    For more information, please visit [https://citypay.com/customer-centre/technical-support.html](https://citypay.com/customer-centre/technical-support.html)

<a name="frameworks-supported"></a>
## Frameworks supported
- .NET Core >= 2.1 
- .NET Framework >=4.6
- Mono/Xamarin >=vNext

<a name="dependencies"></a>
## Dependencies

- [RestSharp](https://www.nuget.org/packages/RestSharp) - 106.13.0 or later
- [Json.NET](https://www.nuget.org/packages/Newtonsoft.Json/) - 13.0.1 or later
- [JsonSubTypes](https://www.nuget.org/packages/JsonSubTypes/) - 1.8.0 or later
- [System.ComponentModel.Annotations](https://www.nuget.org/packages/System.ComponentModel.Annotations) - 5.0.0 or later

The DLLs included in the package may not be the latest version. We recommend using [NuGet](https://docs.nuget.org/consume/installing-nuget) to obtain the latest version of the packages:
```
Install-Package RestSharp
Install-Package Newtonsoft.Json
Install-Package JsonSubTypes
Install-Package System.ComponentModel.Annotations
```

NOTE: RestSharp versions greater than 105.1.0 have a bug which causes file uploads to fail. See [RestSharp#742](https://github.com/restsharp/RestSharp/issues/742).
NOTE: RestSharp for .Net Core creates a new socket for each api call, which can lead to a socket exhaustion problem. See [RestSharp#1406](https://github.com/restsharp/RestSharp/issues/1406).

<a name="installation"></a>
## Installation
Generate the DLL using your preferred tool (e.g. `dotnet build`)

Then include the DLL (under the `bin` folder) in the C# project, and use the namespaces:
```csharp
using CityPayAPI.Api;
using CityPayAPI.Client;
using CityPayAPI.Model;
```
<a name="usage"></a>
## Usage

To use the API client with a HTTP proxy, setup a `System.Net.WebProxy`
```csharp
Configuration c = new Configuration();
System.Net.WebProxy webProxy = new System.Net.WebProxy("http://myProxyUrl:80/");
webProxy.Credentials = System.Net.CredentialCache.DefaultCredentials;
c.Proxy = webProxy;
```

<a name="getting-started"></a>
## Getting Started

```csharp
using System.Collections.Generic;
using System.Diagnostics;
using CityPayAPI.Api;
using CityPayAPI.Client;
using CityPayAPI.Model;

namespace Example
{
    public class Example
    {
        public static void Main()
        {

            Configuration config = new Configuration();
            config.BasePath = "https://api.citypay.com";
            // Create a temporal ApiKey using your client id and licence key
            config.AddApiKey("cp-api-key", new ApiKey("CLIENT_ID", "LICENCE_KEY").GenerateKey());

            var apiInstance = new AuthorisationAndPaymentApi(config);
            var authRequest = new AuthRequest(); // AuthRequest | 

            try
            {
                // Authorisation
                Decision result = apiInstance.AuthorisationRequest(authRequest);
                Debug.WriteLine(result);
            }
            catch (ApiException e)
            {
                Debug.Print("Exception when calling AuthorisationAndPaymentApi.AuthorisationRequest: " + e.Message );
                Debug.Print("Status Code: "+ e.ErrorCode);
                Debug.Print(e.StackTrace);
            }

        }
    }
}
```

<a name="documentation-for-api-endpoints"></a>
## Documentation for API Endpoints

All URIs are relative to *https://api.citypay.com*

Class | Method | HTTP request | Description
------------ | ------------- | ------------- | -------------
*AuthorisationAndPaymentApi* | [**AuthorisationRequest**](docs/AuthorisationAndPaymentApi.md#authorisationrequest) | **POST** /v6/authorise | Authorisation
*AuthorisationAndPaymentApi* | [**BinRangeLookupRequest**](docs/AuthorisationAndPaymentApi.md#binrangelookuprequest) | **POST** /v6/bin | Bin Lookup
*AuthorisationAndPaymentApi* | [**CResRequest**](docs/AuthorisationAndPaymentApi.md#cresrequest) | **POST** /v6/cres | CRes
*AuthorisationAndPaymentApi* | [**CaptureRequest**](docs/AuthorisationAndPaymentApi.md#capturerequest) | **POST** /v6/capture | Capture
*AuthorisationAndPaymentApi* | [**PaResRequest**](docs/AuthorisationAndPaymentApi.md#paresrequest) | **POST** /v6/pares | PaRes
*AuthorisationAndPaymentApi* | [**RefundRequest**](docs/AuthorisationAndPaymentApi.md#refundrequest) | **POST** /v6/refund | Refund
*AuthorisationAndPaymentApi* | [**RetrievalRequest**](docs/AuthorisationAndPaymentApi.md#retrievalrequest) | **POST** /v6/retrieve | Retrieval
*AuthorisationAndPaymentApi* | [**VoidRequest**](docs/AuthorisationAndPaymentApi.md#voidrequest) | **POST** /v6/void | Void
*BatchProcessingApi* | [**BatchProcessRequest**](docs/BatchProcessingApi.md#batchprocessrequest) | **POST** /v6/batch/process | Batch Process Request
*BatchProcessingApi* | [**BatchReportRequest**](docs/BatchProcessingApi.md#batchreportrequest) | **POST** /v6/batch/retrieve | BatchReportRequest
*BatchProcessingApi* | [**CheckBatchStatusRequest**](docs/BatchProcessingApi.md#checkbatchstatusrequest) | **POST** /v6/batch/status | CheckBatchStatus
*CardHolderAccountApi* | [**AccountCardDeleteRequest**](docs/CardHolderAccountApi.md#accountcarddeleterequest) | **DELETE** /v6/account/{accountid}/card/{cardId} | Card Deletion
*CardHolderAccountApi* | [**AccountCardRegisterRequest**](docs/CardHolderAccountApi.md#accountcardregisterrequest) | **POST** /v6/account/{accountid}/register | Card Registration
*CardHolderAccountApi* | [**AccountCardStatusRequest**](docs/CardHolderAccountApi.md#accountcardstatusrequest) | **POST** /v6/account/{accountid}/card/{cardId}/status | Card Status
*CardHolderAccountApi* | [**AccountChangeContactRequest**](docs/CardHolderAccountApi.md#accountchangecontactrequest) | **POST** /v6/account/{accountid}/contact | Contact Details Update
*CardHolderAccountApi* | [**AccountCreate**](docs/CardHolderAccountApi.md#accountcreate) | **POST** /v6/account/create | Account Create
*CardHolderAccountApi* | [**AccountDeleteRequest**](docs/CardHolderAccountApi.md#accountdeleterequest) | **DELETE** /v6/account/{accountid} | Account Deletion
*CardHolderAccountApi* | [**AccountExistsRequest**](docs/CardHolderAccountApi.md#accountexistsrequest) | **GET** /v6/account-exists/{accountid} | Account Exists
*CardHolderAccountApi* | [**AccountRetrieveRequest**](docs/CardHolderAccountApi.md#accountretrieverequest) | **GET** /v6/account/{accountid} | Account Retrieval
*CardHolderAccountApi* | [**AccountStatusRequest**](docs/CardHolderAccountApi.md#accountstatusrequest) | **POST** /v6/account/{accountid}/status | Account Status
*CardHolderAccountApi* | [**ChargeRequest**](docs/CardHolderAccountApi.md#chargerequest) | **POST** /v6/charge | Charge
*DirectPostApi* | [**DirectCResAuthRequest**](docs/DirectPostApi.md#directcresauthrequest) | **POST** /direct/cres/auth/{uuid} | Handles a CRes response from ACS, returning back the result of authorisation
*DirectPostApi* | [**DirectCResTokeniseRequest**](docs/DirectPostApi.md#directcrestokeniserequest) | **POST** /direct/cres/tokenise/{uuid} | Handles a CRes response from ACS, returning back a token for future authorisation
*DirectPostApi* | [**DirectPostAuthRequest**](docs/DirectPostApi.md#directpostauthrequest) | **POST** /direct/auth | Direct Post Auth Request
*DirectPostApi* | [**DirectPostTokeniseRequest**](docs/DirectPostApi.md#directposttokeniserequest) | **POST** /direct/tokenise | Direct Post Tokenise Request
*DirectPostApi* | [**TokenRequest**](docs/DirectPostApi.md#tokenrequest) | **POST** /direct/token | Direct Post Token Request
*OperationalFunctionsApi* | [**AclCheckRequest**](docs/OperationalFunctionsApi.md#aclcheckrequest) | **POST** /v6/acl/check | ACL Check Request
*OperationalFunctionsApi* | [**DomainKeyCheckRequest**](docs/OperationalFunctionsApi.md#domainkeycheckrequest) | **POST** /dk/check | Domain Key Check Request
*OperationalFunctionsApi* | [**DomainKeyGenRequest**](docs/OperationalFunctionsApi.md#domainkeygenrequest) | **POST** /dk/gen | Domain Key Generation Request
*OperationalFunctionsApi* | [**ListMerchantsRequest**](docs/OperationalFunctionsApi.md#listmerchantsrequest) | **GET** /v6/merchants/{clientid} | List Merchants Request
*OperationalFunctionsApi* | [**PingRequest**](docs/OperationalFunctionsApi.md#pingrequest) | **POST** /v6/ping | Ping Request
*PaylinkApi* | [**TokenAdjustmentRequest**](docs/PaylinkApi.md#tokenadjustmentrequest) | **POST** /paylink/{token}/adjustment | Paylink Token Adjustment
*PaylinkApi* | [**TokenCloseRequest**](docs/PaylinkApi.md#tokencloserequest) | **PUT** /paylink/{token}/close | Close Paylink Token
*PaylinkApi* | [**TokenCreateBillPaymentRequest**](docs/PaylinkApi.md#tokencreatebillpaymentrequest) | **POST** /paylink/bill-payment | Create Bill Payment Paylink Token
*PaylinkApi* | [**TokenCreateRequest**](docs/PaylinkApi.md#tokencreaterequest) | **POST** /paylink/create | Create Paylink Token
*PaylinkApi* | [**TokenPurgeAttachmentsRequest**](docs/PaylinkApi.md#tokenpurgeattachmentsrequest) | **PUT** /paylink/{token}/purge-attachments | Purges any attachments for a Paylink Token
*PaylinkApi* | [**TokenReconciledRequest**](docs/PaylinkApi.md#tokenreconciledrequest) | **PUT** /paylink/{token}/reconciled | Reconcile Paylink Token
*PaylinkApi* | [**TokenReopenRequest**](docs/PaylinkApi.md#tokenreopenrequest) | **PUT** /paylink/{token}/reopen | Reopen Paylink Token
*PaylinkApi* | [**TokenStatusChangesRequest**](docs/PaylinkApi.md#tokenstatuschangesrequest) | **POST** /paylink/token/changes | Paylink Token Audit
*PaylinkApi* | [**TokenStatusRequest**](docs/PaylinkApi.md#tokenstatusrequest) | **GET** /paylink/{token}/status | Paylink Token Status


<a name="documentation-for-models"></a>
## Documentation for Models

 - [Model.AccountCreate](docs/AccountCreate.md)
 - [Model.AccountStatus](docs/AccountStatus.md)
 - [Model.Acknowledgement](docs/Acknowledgement.md)
 - [Model.AclCheckRequest](docs/AclCheckRequest.md)
 - [Model.AclCheckResponseModel](docs/AclCheckResponseModel.md)
 - [Model.AirlineAdvice](docs/AirlineAdvice.md)
 - [Model.AirlineSegment](docs/AirlineSegment.md)
 - [Model.AuthReference](docs/AuthReference.md)
 - [Model.AuthReferences](docs/AuthReferences.md)
 - [Model.AuthRequest](docs/AuthRequest.md)
 - [Model.AuthResponse](docs/AuthResponse.md)
 - [Model.AuthenRequired](docs/AuthenRequired.md)
 - [Model.Batch](docs/Batch.md)
 - [Model.BatchReportRequest](docs/BatchReportRequest.md)
 - [Model.BatchReportResponseModel](docs/BatchReportResponseModel.md)
 - [Model.BatchTransaction](docs/BatchTransaction.md)
 - [Model.BatchTransactionResultModel](docs/BatchTransactionResultModel.md)
 - [Model.Bin](docs/Bin.md)
 - [Model.BinLookup](docs/BinLookup.md)
 - [Model.CResAuthRequest](docs/CResAuthRequest.md)
 - [Model.CaptureRequest](docs/CaptureRequest.md)
 - [Model.Card](docs/Card.md)
 - [Model.CardHolderAccount](docs/CardHolderAccount.md)
 - [Model.CardStatus](docs/CardStatus.md)
 - [Model.ChargeRequest](docs/ChargeRequest.md)
 - [Model.CheckBatchStatus](docs/CheckBatchStatus.md)
 - [Model.CheckBatchStatusResponse](docs/CheckBatchStatusResponse.md)
 - [Model.ContactDetails](docs/ContactDetails.md)
 - [Model.Decision](docs/Decision.md)
 - [Model.DirectPostRequest](docs/DirectPostRequest.md)
 - [Model.DirectTokenAuthRequest](docs/DirectTokenAuthRequest.md)
 - [Model.DomainKeyCheckRequest](docs/DomainKeyCheckRequest.md)
 - [Model.DomainKeyRequest](docs/DomainKeyRequest.md)
 - [Model.DomainKeyResponse](docs/DomainKeyResponse.md)
 - [Model.Error](docs/Error.md)
 - [Model.EventDataModel](docs/EventDataModel.md)
 - [Model.Exists](docs/Exists.md)
 - [Model.ExternalMPI](docs/ExternalMPI.md)
 - [Model.ListMerchantsResponse](docs/ListMerchantsResponse.md)
 - [Model.MCC6012](docs/MCC6012.md)
 - [Model.Merchant](docs/Merchant.md)
 - [Model.PaResAuthRequest](docs/PaResAuthRequest.md)
 - [Model.PaylinkAddress](docs/PaylinkAddress.md)
 - [Model.PaylinkAdjustmentRequest](docs/PaylinkAdjustmentRequest.md)
 - [Model.PaylinkAttachmentRequest](docs/PaylinkAttachmentRequest.md)
 - [Model.PaylinkAttachmentResult](docs/PaylinkAttachmentResult.md)
 - [Model.PaylinkBillPaymentTokenRequest](docs/PaylinkBillPaymentTokenRequest.md)
 - [Model.PaylinkCardHolder](docs/PaylinkCardHolder.md)
 - [Model.PaylinkCart](docs/PaylinkCart.md)
 - [Model.PaylinkCartItemModel](docs/PaylinkCartItemModel.md)
 - [Model.PaylinkConfig](docs/PaylinkConfig.md)
 - [Model.PaylinkCustomParam](docs/PaylinkCustomParam.md)
 - [Model.PaylinkEmailNotificationPath](docs/PaylinkEmailNotificationPath.md)
 - [Model.PaylinkErrorCode](docs/PaylinkErrorCode.md)
 - [Model.PaylinkFieldGuardModel](docs/PaylinkFieldGuardModel.md)
 - [Model.PaylinkPartPayments](docs/PaylinkPartPayments.md)
 - [Model.PaylinkSMSNotificationPath](docs/PaylinkSMSNotificationPath.md)
 - [Model.PaylinkStateEvent](docs/PaylinkStateEvent.md)
 - [Model.PaylinkTokenCreated](docs/PaylinkTokenCreated.md)
 - [Model.PaylinkTokenRequestModel](docs/PaylinkTokenRequestModel.md)
 - [Model.PaylinkTokenStatus](docs/PaylinkTokenStatus.md)
 - [Model.PaylinkTokenStatusChangeRequest](docs/PaylinkTokenStatusChangeRequest.md)
 - [Model.PaylinkTokenStatusChangeResponse](docs/PaylinkTokenStatusChangeResponse.md)
 - [Model.PaylinkUI](docs/PaylinkUI.md)
 - [Model.Ping](docs/Ping.md)
 - [Model.ProcessBatchRequest](docs/ProcessBatchRequest.md)
 - [Model.ProcessBatchResponse](docs/ProcessBatchResponse.md)
 - [Model.RefundRequest](docs/RefundRequest.md)
 - [Model.RegisterCard](docs/RegisterCard.md)
 - [Model.RequestChallenged](docs/RequestChallenged.md)
 - [Model.RetrieveRequest](docs/RetrieveRequest.md)
 - [Model.ThreeDSecure](docs/ThreeDSecure.md)
 - [Model.TokenisationResponseModel](docs/TokenisationResponseModel.md)
 - [Model.VoidRequest](docs/VoidRequest.md)


<a name="documentation-for-authorization"></a>
## Documentation for Authorization

<a name="cp-api-key"></a>
### cp-api-key

- **Type**: API key
- **API key parameter name**: cp-api-key
- **Location**: HTTP header

<a name="cp-domain-key"></a>
### cp-domain-key

- **Type**: API key
- **API key parameter name**: cp-domain-key
- **Location**: URL query string

